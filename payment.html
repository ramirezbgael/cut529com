<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get CUT529 - Premium Download</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="payment-styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- <script src="https://js.stripe.com/v3/"></script> -->
</head>

<body>
    <nav>
        <div class="nav-container">
            <div class="logo-nav">
                <h3 class="knife">⺈</h3>
                <span class="nav-brand">CUT529</span>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Back to Home</a></li>
            </ul>
        </div>
    </nav>

    <main class="payment-main">
        <div class="payment-container">
            <!-- Left side - Product info -->
            <div class="download-info">
                <div class="download-header">
                    <i class="fas fa-download download-icon"></i>
                    <h1>Get CUT529</h1>
                    <p class="download-subtitle">AI-powered protection starts in 30 seconds</p>
                </div>

                <div class="plan-summary">
                    <div class="selected-plan" id="selectedPlan">
                        <div class="plan-badge">
                            <i class="fas fa-gift"></i>
                            FREE TRIAL
                        </div>
                        <h3>7-Day Free Trial</h3>
                        <div class="plan-price-display">$0.00</div>
                        <p class="plan-description">Full premium features, 7 days completely free</p>
                    </div>
                </div>

                <div class="included-features">
                    <h4><i class="fas fa-shield-alt"></i> What you get instantly:</h4>
                    <ul>
                        <li><i class="fas fa-check"></i> Immediate download link</li>
                        <li><i class="fas fa-check"></i> Visual AI analysis</li>
                        <li><i class="fas fa-check"></i> Advanced irrevocable mode</li>
                        <li><i class="fas fa-check"></i> Protected activity log</li>
                        <li><i class="fas fa-check"></i> 24/7 email support</li>
                    </ul>
                </div>

                <div class="trust-indicators">
                    <div class="trust-item">
                        <i class="fas fa-lock"></i>
                        <span>256-bit SSL encryption</span>
                    </div>
                    <div class="trust-item">
                        <i class="fas fa-credit-card"></i>
                        <span>Secure payment with Stripe</span>
                    </div>
                    <div class="trust-item">
                        <i class="fas fa-undo"></i>
                        <span>30-day money back guarantee</span>
                    </div>
                </div>
            </div>

            <!-- Right side - Payment form -->
            <div class="payment-form-container">
                <div class="payment-form-header">
                    <h2>Complete your download</h2>
                    <p>One step closer to freedom</p>
                </div>

                <!-- Plan selector -->
                <div class="plan-selector">
                    <div class="plan-option selected trial-highlight" data-plan="trial" data-price="0">
                        <input type="radio" name="plan" id="trial" value="trial" checked>
                        <label for="trial">
                            <div class="plan-option-content">
                                <h4>7-Day FREE Trial</h4>
                                <span class="price">$0</span>
                                <p>Full premium features</p>
                                <span class="popular trial-badge">FREE TRIAL</span>
                            </div>
                        </label>
                    </div>
                    <div class="plan-option" data-plan="basic" data-price="10">
                        <input type="radio" name="plan" id="basic" value="basic">
                        <label for="basic">
                            <div class="plan-option-content">
                                <h4>Get Free Plan</h4>
                                <span class="price">$10</span>
                                <p>Basic protection</p>
                            </div>
                        </label>
                    </div>
                    <div class="plan-option" data-plan="premium" data-price="100">
                        <input type="radio" name="plan" id="premium" value="premium">
                        <label for="premium">
                            <div class="plan-option-content">
                                <h4>Stay Clean Plan</h4>
                                <span class="price">$100</span>
                                <p>Complete protection</p>
                                <span class="popular">Most Popular</span>
                            </div>
                        </label>
                    </div>
                    <div class="plan-option" data-plan="enterprise" data-price="1000">
                        <input type="radio" name="plan" id="enterprise" value="enterprise">
                        <label for="enterprise">
                            <div class="plan-option-content">
                                <h4>No Way Back Plan</h4>
                                <span class="price">$1,000</span>
                                <p>Network + therapy</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Payment form -->
                <form id="payment-form">
                    <div class="form-section">
                        <h3>Your information</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email">Email address</label>
                                <input type="email" id="email" name="email" required autocomplete="email" inputmode="email" aria-describedby="emailError" pattern="^(?!.*\+)[^\s@]+@[^\s@]+\.[A-Za-z]{2,}$">
                                <small>We'll send your download link here</small>
                                <small id="emailError" class="error-text hidden" role="alert"></small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="name">Full name</label>
                                <input type="text" id="name" name="name" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Payment method</h3>
                        <div id="card-element">
                            <!-- Stripe Elements will create form elements here -->
                        </div>
                        <div id="card-errors" role="alert"></div>
                    </div>

                    <div class="payment-summary" aria-live="polite">
                        <div class="summary-row">
                            <span>CUT529 Premium</span>
                            <span id="summaryPrice">$0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Secure processing</span>
                            <span>$0.00</span>
                        </div>
                        <div class="summary-row total">
                            <span id="totalLabel">Total today</span>
                            <span id="totalPrice">$0.00</span>
                        </div>
                    </div>

                    <button type="submit" id="submit" class="download-button">
                        <span id="button-text"><i class="fas fa-gift"></i> Start FREE Trial — $0.00</span>
                        <div id="spinner" class="hidden">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                    </button>

                    <div class="micro-assurance" aria-live="polite">
                        <p id="preorderNote" class="hidden"><i class="fas fa-clock"></i> Pre‑order: Get Stay Clean Plan today. Remaining features delivered on December 14.</p>
                        <p><i class="fas fa-eye-slash"></i> No hidden fees</p>
                    </div>

                    <div class="payment-footer">
                        <p>
                            <i class="fas fa-shield-alt"></i>
                            Protected by industry-standard encryption. Your payment information is secure.
                        </p>
                        <p class="terms">
                            By continuing, you agree to our 
                            <a href="terms.html" target="_blank">Terms of Service</a> and 
                            <a href="privacy.html" target="_blank">Privacy Policy</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>

        <!-- Success modal -->
        <div id="success-modal" class="modal hidden">
            <div class="modal-content">
                <div class="success-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>Download Ready!</h2>
                <p id="modalSubtitle">Check your email for the download link and setup instructions.</p>
                <p id="modalPreorder" class="hidden">Pre‑order confirmed: You have immediate access to Stay Clean Plan. Remaining features will be delivered on <strong>December 14</strong>.</p>
                <div class="success-actions">
                    <button onclick="window.open('mailto:', '_blank')" class="action-button">
                        <i class="fas fa-envelope"></i>
                        Check Email
                    </button>
                    <button onclick="window.location.href='index.html'" class="action-button secondary">
                        <i class="fas fa-home"></i>
                        Back to Home
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Stripe deshabilitado temporalmente
        const paymentsEnabled = false;

        // Custom styling for Stripe elements
        const style = {
            base: {
                color: '#fff',
                fontFamily: 'Inter, sans-serif',
                fontSmoothing: 'antialiased',
                fontSize: '16px',
                '::placeholder': {
                    color: '#aab7c4'
                }
            },
            invalid: {
                color: '#fa755a',
                iconColor: '#fa755a'
            }
        };

        // Stripe Elements deshabilitado
        // (No se inicializa Stripe ni se monta el elemento de tarjeta)

        // Validación en vivo deshabilitada (Stripe apagado)

        // Currency formatting helper
        function formatUSD(value) {
            const amount = typeof value === 'number' ? value : parseFloat(value);
            if (Number.isNaN(amount)) return '$0.00';
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);
        }

        // Common disposable/temporary email domains
        const disposableEmailDomains = new Set([
            'mailinator.com', 'tempmail.com', 'yopmail.com', '10minutemail.com', 'guerrillamail.com',
            'trashmail.com', 'throwawaymail.com', 'sharklasers.com', 'getnada.com', 'dispostable.com',
            'maildrop.cc', 'moakt.com', 'mailnesia.com', 'temp-mail.org', 'fakeinbox.com', 'mintemail.com',
            'mailcatch.com', 'spambog.com', 'spambog.ru', 'spambox.us', 'spamgourmet.com'
        ]);

        function isDisposableDomain(domain) {
            if (!domain) return false;
            const lower = domain.toLowerCase();
            for (const d of disposableEmailDomains) {
                if (lower === d || lower.endsWith('.' + d)) return true;
            }
            return false;
        }

        // Email validation helper (no plus addressing, general shape, no leading/trailing dots, valid TLD)
        function getEmailError(value) {
            if (!value) return '';
            if (value.includes('+')) return 'Plus addressing (+) is not allowed.';
            const emailPattern = /^[^\s@]+@[^\s@]+\.[A-Za-z]{2,}$/;
            if (!emailPattern.test(value)) return 'Enter a valid email address.';
            const [local, domain] = value.split('@');
            if (!local || !domain) return 'Enter a valid email address.';
            if (local.startsWith('.') || local.endsWith('.')) return 'Enter a valid email address.';
            if (domain.startsWith('-') || domain.endsWith('-')) return 'Enter a valid email address.';
            if (domain.includes('..')) return 'Enter a valid email address.';
            if (isDisposableDomain(domain)) return 'Disposable email domains are not allowed.';
            return '';
        }

        // Handle plan selection
        document.querySelectorAll('.plan-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.plan-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input').checked = true;
                
                const price = this.dataset.price;
                const plan = this.dataset.plan;
                
                // Update UI
                document.getElementById('summaryPrice').textContent = formatUSD(price);
                document.getElementById('totalPrice').textContent = formatUSD(price);
                
                // Update button text and icon based on plan
                const buttonText = document.getElementById('button-text');
                const buttonIcon = buttonText.querySelector('i');
                
                if (plan === 'trial') {
                    buttonIcon.className = 'fas fa-gift';
                    buttonText.innerHTML = `<i class=\"fas fa-gift\"></i> Start FREE Trial — ${formatUSD(price)}`;
                    document.getElementById('totalLabel').textContent = 'Total today';
                    document.getElementById('preorderNote').classList.add('hidden');
                    document.getElementById('modalPreorder').classList.add('hidden');
                    document.getElementById('modalSubtitle').textContent = 'Check your email for the download link and setup instructions.';
                } else if (plan === 'enterprise') {
                    buttonIcon.className = 'fas fa-download';
                    buttonText.innerHTML = `<i class=\"fas fa-download\"></i> Pre order now — ${formatUSD(price)}`;
                    document.getElementById('totalLabel').textContent = 'Pre-order total today';
                    document.getElementById('preorderNote').classList.remove('hidden');
                    document.getElementById('modalPreorder').classList.remove('hidden');
                    document.getElementById('modalSubtitle').textContent = 'Pre‑order confirmed. Check your email for access to Stay Clean Plan.';
                } else {
                    buttonIcon.className = 'fas fa-download';
                    buttonText.innerHTML = `<i class=\"fas fa-download\"></i> Complete Purchase — ${formatUSD(price)}`;
                    document.getElementById('totalLabel').textContent = 'Total today';
                    document.getElementById('preorderNote').classList.add('hidden');
                    document.getElementById('modalPreorder').classList.add('hidden');
                    document.getElementById('modalSubtitle').textContent = 'Check your email for the download link and setup instructions.';
                }
                
                // Update selected plan display
                updateSelectedPlanDisplay(plan, price);
            });
        });

        function updateSelectedPlanDisplay(plan, price) {
            const plans = {
                trial: {
                    name: '7-Day Free Trial',
                    description: 'Full premium features, 7 days completely free',
                    badge: 'FREE TRIAL',
                    icon: 'fas fa-gift'
                },
                basic: {
                    name: 'Get Free Plan',
                    description: 'Basic protection with smart URL blocking',
                    badge: 'ESSENTIAL',
                    icon: 'fas fa-shield'
                },
                premium: {
                    name: 'Stay Clean Plan',
                    description: 'Complete protection with visual AI analysis',
                    badge: 'MOST POPULAR',
                    icon: 'fas fa-star'
                },
                enterprise: {
                    name: 'No Way Back Plan',
                    description: 'Includes immediate access to Stay Clean Plan. Remaining features on December 14.',
                    badge: 'COMPLETE SOLUTION',
                    icon: 'fas fa-crown'
                }
            };

            const selectedPlan = document.getElementById('selectedPlan');
            const planData = plans[plan];
            
            selectedPlan.innerHTML = `
                <div class="plan-badge">

                    ${planData.badge}
                </div>
                <h3>${planData.name}</h3>
                <div class="plan-price-display">${formatUSD(price)}</div>
                <p class="plan-description">${planData.description}</p>
            `;
        }

        // Handle form submission
        const form = document.getElementById('payment-form');
        const emailInput = document.getElementById('email');
        const emailError = document.getElementById('emailError');

        function showEmailError(message) {
            emailError.textContent = message;
            emailError.classList.remove('hidden');
            emailInput.setAttribute('aria-invalid', 'true');
        }

        function clearEmailError() {
            emailError.textContent = '';
            emailError.classList.add('hidden');
            emailInput.removeAttribute('aria-invalid');
        }

        // Validate on blur (not on every keystroke) to avoid noisy UX
        emailInput.addEventListener('blur', () => {
            const value = emailInput.value.trim();
            const error = getEmailError(value);
            if (error) {
                showEmailError(error);
            } else {
                clearEmailError();
            }
        });

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            const value = emailInput.value.trim();
            const error = getEmailError(value);
            if (error) {
                showEmailError(error);
                emailInput.focus();
                return;
            }
            const errorElement = document.getElementById('card-errors');
            errorElement.textContent = 'Los pagos están temporalmente deshabilitados.';
        });

        function submitFormWithToken(token) {
            // Show loading state
            const button = document.getElementById('submit');
            const buttonText = document.getElementById('button-text');
            const spinner = document.getElementById('spinner');
            
            button.disabled = true;
            buttonText.classList.add('hidden');
            spinner.classList.remove('hidden');

            // Get form data
            const formData = {
                token: token.id,
                email: document.getElementById('email').value,
                name: document.getElementById('name').value,
                plan: document.querySelector('input[name="plan"]:checked').value,
                amount: document.querySelector('.plan-option.selected').dataset.price
            };

            // Stripe deshabilitado; no se enviará el pago
            button.disabled = false;
            buttonText.classList.remove('hidden');
            spinner.classList.add('hidden');

            // Actual implementation would be:
            /*
            fetch('/process-payment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('success-modal').classList.remove('hidden');
                } else {
                    // Handle error
                    document.getElementById('card-errors').textContent = data.error;
                }
            })
            .finally(() => {
                button.disabled = false;
                buttonText.classList.remove('hidden');
                spinner.classList.add('hidden');
            });
            */
        }

        // Close modal when clicking outside
        document.getElementById('success-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
            }
        });
    </script>
</body>

</html> 